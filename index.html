<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Waco GIS Story</title>

  <!-- Leaflet CSS -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
  />

  <style>
    html, body {
      height: 100%;
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
    }

    #container {
      display: flex;
      height: 100vh;
      width: 100vw;
    }

    #map {
      width: 70%;
      height: 100%;
    }

    #story {
      width: 30%;
      height: 100%;
      padding: 1.25rem;
      overflow-y: auto;
      background: #fafafa;
      border-left: 1px solid #ddd;
    }

    #story h2 {
      margin-top: 0;
    }

    #date {
      font-size: 0.85rem;
      color: #666;
      margin-bottom: 1rem;
    }
  </style>
</head>
<body>

<div id="container">
  <!-- MAP -->
  <div id="map"></div>

  <!-- STORY PANEL -->
  <div id="story">
    <h2 id="title">Waco GIS Story</h2>
    <div id="date">Context</div>
    <p>
      Texas boundary and Waco point loaded from GeoJSON hosted on GitHub Pages.
    </p>
  </div>
</div>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
/* ======================
   MAP SETUP
====================== */

const map = L.map('map').setView([31.5, -99], 6);

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: '&copy; OpenStreetMap contributors'
}).addTo(map);

// Hold layer references
let texasLayer = null;
let poiLayer = null;

/* ======================
   LOAD TEXAS BOUNDARY
====================== */

// Use encodeURI to safely handle spaces in filename
fetch(encodeURI('./data/Texas Boundary.geojson'))
  .then(res => {
    if (!res.ok) throw new Error('Failed to load Texas boundary');
    return res.json();
  })
  .then(data => {
    texasLayer = L.geoJSON(data, {
      style: {
        color: '#222',
        weight: 2,
        fillOpacity: 0.05
      }
    }).addTo(map);

    // Zoom map to Texas
    map.fitBounds(texasLayer.getBounds(), {
      padding: [30, 30]
    });
  })
  .catch(err => console.error(err));

/* ======================
   LOAD POI (WACO)
====================== */

fetch(encodeURI('./data/POI.geojson'))
  .then(res => {
    if (!res.ok) throw new Error('Failed to load POI');
    return res.json();
  })
  .then(data => {
    poiLayer = L.geoJSON(data, {
      pointToLayer: (feature, latlng) =>
        L.circleMarker(latlng, {
          radius: 7,
          fillColor: '#c0392b',
          color: '#000',
          weight: 1,
          fillOpacity: 0.9
        }),
      onEachFeature: (feature, layer) => {
        if (feature.properties && feature.properties.name) {
          layer.bindPopup(feature.properties.name);
        }
      }
    }).addTo(map);
  })
  .catch(err => console.error(err));

</script>

</body>
</html>
